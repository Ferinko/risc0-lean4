# RISC Zero's Formally Verified Verifier
[RISC Zero](http://www.risczero.com) is building a formally verified verifier for the [RISC Zero zkVM](http://www.github.com/risc0/risc0). 
The source code for the Rust verifier can be found in [zkp/src/verify](https://github.com/risc0/risc0/tree/main/risc0/zkp/src/verify).
This repo contains a work-in-progress [Lean 4](https://leanprover.github.io/) implementation of the Rust verifier. 

### Repo Organization
- Main verification logic 
  - Lean version: [Verify.lean](https://github.com/risc0/risc0-lean4/blob/main/Zkvm/Verify.lean) 
  - Rust version: [verify/mod.rs](https://github.com/risc0/risc0/tree/main/risc0/zkp/src/verify/mod.rs) 
- Merkle verification
  - Lean version: [Merkle.lean](https://github.com/risc0/risc0-lean4/blob/main/Zkvm/Verify/Merkle.lean) 
  - Rust version: [verify/merkle.rs](https://github.com/risc0/risc0/blob/main/risc0/zkp/src/verify/merkle.rs)
- FRI verification
  - Lean version: [Fri.lean](https://github.com/risc0/risc0-lean4/blob/main/Zkvm/Seal/Fri.lean)
  - Rust version: [verify/fri.rs](https://github.com/risc0/risc0/blob/main/risc0/zkp/src/verify/fri.rs) 

### Versioning
This Lean 4 verifier should successfully verify the validity of receipts generated by v0.11 of the RISC Zero zkVM. 


## Getting Lean4

See the [Quickstart guide](https://leanprover.github.io/lean4/doc/quickstart.html).


## Building

First, check to see if `lake` is in your terminal's search path. If not, you either haven't installed Lean4 yet, or you haven't `source`'d the `elan` environment variables.

```console
risc0-lean4$ source ~/.elan/env
```

Now you can perform the build:

```console
risc0-lean4$ lake build
```

## Running the tools

### zkVM verifier

```console
risc0-lean4$ ./build/bin/zkvm-verify-lean4
```

### zkVM emulator

```console
risc0-lean4$ ./build/bin/zkvm-emu-lean4
```

### Elf dumper

```console
risc0-lean4$ ./build/bin/elf-dump-lean4
```

## Building the docs

```console
$ lake -Kdoc=on update
$ lake -Kdoc=on build Elf:docs R0sy:docs RiscV:docs Zkvm:docs Mathlib:docs
```

The docs will be viewable at `build/doc/index.html`.
